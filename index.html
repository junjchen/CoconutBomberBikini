<html>

<head>
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="./css/app.css">

    <script src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.8/handlebars.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bacon.js/0.7.93/Bacon.min.js"></script>
    <script src="./js/app.js"></script>
    <script src="./js/plugins.js"></script>
</head>

<body>
    <ul class="homes">
    </ul>

    <div class="js-d-list">
    </div>

</body>

<script>
    loadData().then(function (data) {
        renderMarkers(data)
        window.addEventListener('hashchange', function (evt) {
            var id = window.location.hash.substr(1)
            selectMarker(data, id)
        })
    })

    function renderMarkers(homes) {
        var ul = document.querySelector('.homes')
        homes.forEach(function (h) {
            var li = document.createElement('li')
            var a = document.createElement('a')
            var text = document.createTextNode(h.id + ' ' + h.name + ' at ' + h.lat + ', ' + h.lon)

            li.setAttribute('data-id', h.id)
            a.setAttribute('href', '#' + h.id)
            a.appendChild(text)
            li.appendChild(a)
            ul.appendChild(li)
        })
    }

    function selectMarker(homes, id) {
        var h = homes.filter(function (x) {
            return x.id == id
        })[0]
        $('.js-d-list').FoodList(h.foods)
    }
</script>

<script id="food-template" type="text/x-custom-template">
    <div class="d-card mdl-card mdl-shadow--2dp" data-id="{{id}}">
        <div class="mdl-card__title" style="background: url('{{image}}') center / cover">
            <h2 class="mdl-card__title-text">{{name}}</h2>
        </div>
        <div class="mdl-card__supporting-text">
            {{description}}
            <div class="d-card__info">
                <span>{{calories}} kcal</span>
                <span class="pull-right">${{price}}</span>
            </div>
        </div>
        <div class="mdl-card__actions mdl-card--border">
            <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
                VIEW DETAILS
            </a>
            <button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored pull-right js-d-card__btn-remove">
                <i class="material-icons">remove</i>
            </button>
            <span class="d-card__amount pull-right">0</span>
            <button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored pull-right js-d-card__btn-add">
                <i class="material-icons">add</i>
            </button>
        </div>
        <div class="mdl-card__menu">
            <button class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect">
                <i class="material-icons">share</i>
            </button>
        </div>
    </div>
</script>

</html>